# 跨域写入cookie解决方案

> cookie 在**不同源**的情况下是写入不进去的

## 什么是同源策略

**源的定义：** 如果两个 URL 的协议、端口（如果有指定的话）和主机都相同的话，则这两个 URL 是同源的。这个方案也被称为“ **协议/主机/端口元组** ”，或者直接是“元组”。（“元组”是指一组项目构成的整体，具有双重/三重/四重/五重等通用形式。）

即 **域名（主机）、端口、协议 相同即同源**

## 写入cookie的方式

1. 前端js写入
2. 通过网络（http、https）请求设置响应头写入

## 跨域写入cookie的方式

如果是子域名关系的不同域名 只需写入到顶级域名（这里不做讨论）

这里讨论的是 a 和 b 域名是完全不同的域名 不属于子域名关系 例如 a.com 、b.com

例如：浏览器访问的是a.com 页面里面接口请求的是b.com

1. 代理服务器（网络写入）（写入到a.com，代理后请求的就是a.com了）
   
   服务器端设置一个代理，将客户端的请求转发到目标服务器。在代理服务器上可以进行必要的 Cookie 设置，然后将响应返回给客户端。这样做的好处是，客户端直接与你的服务器通信，而不用担心跨域问题。

2. 前端写入（写入到a.com）
   
   - 通过接口向服务器间接地将需要的信息传递给客户端，并由客户端自己设置 Cookie。通过 JavaScript 来设置 Cookie。这个方法需要一定的安全性考虑，以避免潜在的安全风险。
   - 由于浏览器的同源策略所以设置Domain属性的域名与当前url域名不一样会设置不成功

3. 设置CORS with credentials（写入到b.com）
   
   服务器端配置 CORS，允许跨域请求并在响应头中设置 Access-Control-Allow-Credentials: true，并在客户端请求时设置 withCredentials 为 true。这样可以实现跨域写入 Cookie。但需要注意，这样做需要目标服务器明确允许你的域名，并且需要注意安全性问题。

4. JSONP（写入到b.com）
   
   利用script标签不受同源策略的影响 后端设置请求头set-cookie

